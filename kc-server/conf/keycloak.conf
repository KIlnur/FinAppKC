# ============================================================
# Keycloak Server Configuration
# ============================================================

# Database
db=postgres
db-url-host=${KC_DB_HOST:localhost}
db-url-port=${KC_DB_PORT:5432}
db-url-database=${KC_DB_NAME:keycloak}
db-username=${KC_DB_USERNAME:keycloak}
db-password=${KC_DB_PASSWORD:keycloak}
db-pool-initial-size=5
db-pool-min-size=5
db-pool-max-size=20

# HTTP
http-enabled=true
http-port=8080

# HTTPS (for production)
# https-port=8443
# https-certificate-file=/opt/keycloak/conf/server.crt
# https-certificate-key-file=/opt/keycloak/conf/server.key

# Hostname
hostname=${KC_HOSTNAME:localhost}
hostname-strict=false
hostname-strict-https=false

# Proxy
proxy-headers=${KC_PROXY_HEADERS:xforwarded}

# Health and metrics
health-enabled=true
metrics-enabled=true

# Histogram metrics for better latency tracking
spi-sticky-session-encoder-infinispan-should-attach-route=false

# Features
features=token-exchange,admin-fine-grained-authz,declarative-user-profile

# Themes
spi-theme-static-max-age=2592000
spi-theme-cache-themes=true
spi-theme-cache-templates=true

# Events
spi-events-listener-jboss-logging-success-level=info
spi-events-listener-jboss-logging-error-level=warn

# Logging
log-level=${KC_LOG_LEVEL:INFO}
log-console-output=default

# For production JSON logs:
# log-console-output=json
